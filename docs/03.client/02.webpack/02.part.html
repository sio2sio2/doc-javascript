


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.2.2. Particularidades &#8212; documentación de Javascript - </title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="3.2.3. Ejemplos" href="03.ejemplos.html" />
    <link rel="prev" title="3.2.1. Configuración básica" href="01.intro.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="03.ejemplos.html" title="3.2.3. Ejemplos"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="01.intro.html" title="3.2.1. Configuración básica"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Javascript - </a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >3. Programación en el cliente</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">3.2. Webpack</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="particularidades">
<h1>3.2.2. Particularidades<a class="headerlink" href="#particularidades" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="punto-de-entrada">
<span id="webpack-entry-point"></span><h2>3.2.2.1. Punto de entrada<a class="headerlink" href="#punto-de-entrada" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hasta ahora hemos definido el punto de entrada de la manera más simple posible:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="s2">&quot;./src/js/index.js&quot;</span>
</pre></div>
</div>
<p>que equivale a:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">main</span><span class="o">:</span> <span class="s2">&quot;./src/js/index.js&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Esta equivalencia es la que provoca que para <strong class="program">webpack</strong> <code class="docutils literal notranslate"><span class="pre">[name]</span></code> se
sustituya por <em>main</em>, por lo que:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;js/[name].bundle.js&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>provoca que el fichero de salida sea <code class="file docutils literal notranslate"><span class="pre">js/main.bundle.js</span></code> (dentro de
<code class="file docutils literal notranslate"><span class="pre">dist/</span></code>, por supuesto). Como ya se ha explicado, este fichero no contiene
únicamente el punto de entrada <code class="file docutils literal notranslate"><span class="pre">src/js/index.js</span></code>, sino que cualquier
script en javascript que se importe dentro de él y, a se vez, los importados por
los importados, pasarán a formar parte de este fichero resultante. Los ficheros
de otra naturaleza importados en el propio código <em>Javascript</em> o a través del
código <abbr title="HyperText Markup Language">HTML</abbr> o <abbr title="Cascading Style Sheets">CSS</abbr> de la aplicación también se procesarán pero para ello será
necesario el uso de plugins y cargadores (como ya se ha practicado) y,
obviamente, el resultado acabará en otros ficheros distintos.</p>
<p>Por tanto, una primera variante es alternar ese nombre predeterminado para
que <code class="docutils literal notranslate"><span class="pre">[name]</span></code> cambie a otro valor más apropiado:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;leaflet.mipluginmolon&quot;</span><span class="o">:</span> <span class="s2">&quot;./src/js/index.js&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>AHora bien, esto no acaba aquí. Si estamos desarrollando una aplicación que se
compone de dos páginas web distintas, las cuales usan sendos scripts, podemos
hacer:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;site&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;./src/js/page1.js&quot;</span><span class="p">,</span> <span class="s2">&quot;./src/js/page2.js&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>lo cual tendrá el efecto de embutir ambos <em>scripts</em><a class="footnote-reference" href="#id9" id="id1">[1]</a> en un único fichero
resultante. Esto es necesario porque al ser dos <em>scripts</em> independientes
utilizar el primero u el segundo como punto de entrada no incluiría al otro en
la salida. Otra variante es:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;page1&quot;</span><span class="o">:</span> <span class="s2">&quot;./src/js.page1.js&quot;</span><span class="p">,</span>
   <span class="s2">&quot;page2&quot;</span><span class="o">:</span> <span class="s2">&quot;./src/js.page2.js&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>que mantendrá ambos <em>scripts</em> separados creando dos ficheros de salida.</p>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p>Cuando el desarrollo no es una aplicación final, sino una librería,
es sumamente importante tener en cuenta que las librerías son útiles porque
ofrecen (o sea, exportan) algo al código que las invoca. Al tratar <a class="reference internal" href="#webpack-output"><span class="std std-ref">la
salida</span></a> volveremos a este concepto. Es indispensable tener
presente que, si un  punto de entrada encadena varios archivos, se exportará
aquello que exporte el último fichero de la lista. Por eso, debe escribirse
esto:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">main</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;./src/index.css&quot;</span><span class="p">,</span> <span class="s2">&quot;./src/index.js&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>y no:</p>
<div class="code js highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">entry</span><span class="p">:</span> <span class="p">{</span>
   <span class="n">main</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;./src/index.js&quot;</span><span class="p">,</span> <span class="s2">&quot;./src/index.css&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">ya que en este segundo caso, se exportará lo que exporte un fichero <abbr title="Cascading Style Sheets">CSS</abbr>, o
sea, nada.</p>
</div>
</div>
<div class="section" id="carga-de-modulos">
<h2>3.2.2.2. Carga de módulos<a class="headerlink" href="#carga-de-modulos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="sistema-de-modulos">
<h3>3.2.2.2.1. Sistema de módulos<a class="headerlink" href="#sistema-de-modulos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Como se verá en los <a class="reference internal" href="03.ejemplos.html#webpack-ejemplos"><span class="std std-ref">ejemplos posteriores</span></a>, lo habitual
es que el código requiera cargar módulos propios o ajenos. <strong class="program">webpack</strong>
permite que se usa tanto el sistema <a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a> como el <em>ES2015</em>. Al respecto:</p>
<ul>
<li><p class="first">Use <a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a> en el fichero de configuración de <strong class="program">webpack</strong>, ya que es
el que soporta nativamente <a class="reference external" href="https://nodejs.org/">NodeJS</a>.</p>
</li>
<li><p class="first">En el código de la aplicación puede usarse tan <a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a> como <em>ES2015</em>. Usar
el segundo, tiene la ventaja de que al ser el estándar aprobado, bajo
determinadas circunstancias (como no importar aplicaciones de terceros<a class="footnote-reference" href="#id10" id="id2">[2]</a>
dentro del propio código), se genera un código directamente usable en
navegadores modernos.</p>
<p>En cualquier caso, nuestra intención no es escribir ficheros directamente
ejecutables por el navegador, así que esta ventaja es muy secundaria.</p>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Tenga presente que hay una diferencia bastante patente entre usar
uno y otro sistema. Cuando se usa el de <em>ES2015</em>, el código siempre se
debe interpretar en modo estricto, porque así es como lo establece la
especificación. En cambio, si se desea la interpretación en modo estricto
usando <em>CommonJS</em> es necesario especificarlo en el código.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="importacion-desde-la-configuracion">
<span id="webpack-conf-import"></span><h3>3.2.2.2.2. Importación desde la configuración<a class="headerlink" href="#importacion-desde-la-configuracion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ya se ha visto que desde el propio código puede llevarse a cabo la importación:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">L</span> <span class="nx">from</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s2">&quot;leaflet/dist/leaflet.css&quot;</span><span class="p">;</span>  <span class="c1">// El CSS de Leaflet</span>
<span class="kr">import</span> <span class="nx">$</span> <span class="nx">from</span> <span class="s2">&quot;jquery&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">logo</span> <span class="nx">from</span> <span class="s2">&quot;images/logo.png&quot;</span><span class="p">;</span>  <span class="c1">// Importación de una imagen.</span>
</pre></div>
</div>
<p>Usando el estilo <em>ES2015</em>; también valdría <a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a>. En principio, sea cual sea
la naturaleza de lo importado (código <em>Javascript</em>, <abbr title="Cascading Style Sheets">CSS</abbr>, una imagen, etc)
podemos usar este método.</p>
<p>Alternativamente, las importaciones también puede hacerse desde el fichero de
configuración, aunque en este caso distinguiremos entre el código <em>Javascript</em> y
el resto.</p>
<ul>
<li><p class="first">Para <strong>código Javascript</strong> puede usarse el plugin <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// webpack.config.js</span>
<span class="kr">const</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;webpack&quot;</span><span class="p">);</span>

<span class="c1">// ...</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
   <span class="c1">// ...</span>
   <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
      <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
         <span class="nx">L</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
         <span class="nx">$</span><span class="o">:</span> <span class="s2">&quot;jquery&quot;</span>
      <span class="p">})</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Para configurar el <em>plugin</em> hay que entender que las claves son identificadores
y los valores cuál módulo se carga, de manera que cuando <strong class="program">webpack</strong>
encuentre el identificador <code class="code docutils literal notranslate"><span class="pre">L</span></code> en el código procede a cargar el módulo
<em>leaflet</em><a class="footnote-reference" href="#id11" id="id3">[3]</a>. El identificador puede ser la propiedad de un objeto. Por
ejemplo, esto es perfectamente válido:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
      <span class="nx">L</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
      <span class="s2">&quot;L.Control.Search&quot;</span><span class="o">:</span> <span class="s2">&quot;leaflet-search&quot;</span><span class="p">,</span>
      <span class="nx">$</span><span class="o">:</span> <span class="s2">&quot;jquery&quot;</span>
   <span class="p">})</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Entiéndase que lo exportado por el módulo cargado es el valor que
adquirirá el identificar en el código. Ahora bien, si el módulo exporta de esta
manera:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">export</span> <span class="p">{</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">}</span>
</pre></div>
</div>
<p>y nuestra intención es definir el identificador <em>a</em>, podemos entonces hacer:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;./mimodulo.js&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span> <span class="p">]</span>
</pre></div>
</div>
<p>suponiendo que también lo hayamos importado con el nombre «<em>a</em>» en el código,
porque podríamos haber usado otro.</p>
</li>
<li><p class="first">El <strong>resto</strong> de importaciones podemos llevarlas a cabo añadiéndolas al punto
de entrada:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;leaflet.mipluginmolon&quot;</span><span class="o">:</span> <span class="p">[</span>
       <span class="s2">&quot;leaflet/dist/leaflet.css&quot;</span><span class="p">,</span>
       <span class="s2">&quot;./src/js/index.js&quot;</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning" id="webpack-css-no-externals">
<p class="first admonition-title">Advertencia</p>
<p>No hay ningún problema en usar el plugin <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a>, en resultados
en que no incluimos dependencias (véase el próximo epígrafe), ya que los
propios ficheros contendrán la referencia a las dependencias, y si los usamos
como componentes en el desarollo posterior de una aplicación web, las
dependencias se cargarán. En cambio, la estrategia propuesta de cambiar el punto
de entrada para incorporar <abbr title="Cascading Style Sheets">CSS</abbr> en los resultados con dependencias, hace que
en los resultados sin dependencias, no haya rastro de la referencia al <abbr title="Cascading Style Sheets">CSS</abbr>
por lo que en el desarrollo posterior de una aplicación web habría que volver
a hacer referencia a este <abbr title="Cascading Style Sheets">CSS</abbr>. Dicho con un ejemplos, si en el desarrollo
de la aplicación web hacemos:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="s2">&quot;leaflet.mipluginmolon/dist/leaflet.mipluginmolon.css&quot;</span>
<span class="kr">import</span> <span class="s2">&quot;leaflet.mipluginmolon/dist/leaflet.mipluginmolon.js&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p class="last">suponiendo que ese <abbr title="Cascading Style Sheets">CSS</abbr> y ese <em>Javascript</em> no incluyen código de <a class="reference external" href="https://leafletjs.com">Leaflet</a>,
lograremos la carga del código <em>Javascript</em>  de <a class="reference external" href="https://leafletjs.com">Leaflet</a>, pero no la carga
de su <abbr title="Cascading Style Sheets">CSS</abbr>.</p>
</div>
</div>
<div class="section" id="exclusion-de-dependecias">
<h3>3.2.2.2.3. Exclusión de dependecias<a class="headerlink" href="#exclusion-de-dependecias" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si nuestra intención es desarrollar una librería es bastante probable que
queramos desarrollar varias salidas y alguna de ellas no contenga las
dependencias.</p>
<div class="admonition seealso">
<p class="first admonition-title">Ver también</p>
<p class="last">Véase el epígrafe dedicado a <a class="reference internal" href="#webpack-multi"><span class="std std-ref">múltiples salidas</span></a>.</p>
</div>
<p>Para excluir de la salida las dependencias, de nuevo, hay que hacer distinción
entre el código <em>Javascript</em> y el resto:</p>
<ul id="webpack-externals">
<li><p class="first">El <strong>codigo Javascript</strong> debe cargarse y excluirse, no simplemente dejar de
cargarse. Se haya cargado en el código o en la configuración, el método de
exclusión es el mismo: el atributo <a class="reference external" href="https://webpack.js.org/configuration/externals/">externals</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
   <span class="c1">// ...</span>
   <span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">leaflet</span><span class="o">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
      <span class="nx">jquery</span><span class="o">:</span> <span class="s2">&quot;$&quot;</span><span class="p">,</span>
      <span class="s2">&quot;leaflet-search&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="s2">&quot;Search&quot;</span> <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En este caso, las claves representan las librerías <em>externalizadas</em> (o sea, los
valores del objeto que se pasó como argumento a <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a>) y los valores son la
variable global asociada a aquello que exporte la librería. Por tanto, muy
comúnmente al usar <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a> y externals lo que se hace es intercambiar claves
por valores y valores con claves, con la diferencia que en <em>externals</em> un
identificador que no sea global, sino el atributo de otro objeto debe notarse en
forma de <em>array</em>. Es por ello que <code class="code docutils literal notranslate"><span class="pre">L.Control.Search</span></code> se ha convertido en
<code class="code docutils literal notranslate"><span class="pre">[&quot;L&quot;,</span> <span class="pre">&quot;Control&quot;,</span> <span class="pre">&quot;Search&quot;]</span></code>.</p>
<p>No obstante, si la librería externa se construyó como <a class="reference internal" href="../../02.node/03.modulos.html#mod-umd"><span class="std std-ref">módulo UMD</span></a>, entonces es necesario definir cómo está disponible la librería
dependiendo del sistema que se use para cargarla:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">leaflet</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">root</span><span class="o">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
      <span class="nx">commonjs</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
      <span class="nx">commonjs2</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
      <span class="nx">amd</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Si creamos una librería de terceros que queremos, no sólo que pueda
cargarse desde un navegador, sino que pueda usarse como componente en un
desarrollo posterior con <a class="reference external" href="https://nodejs.org/">NodeJS</a>, deberemos usar esta ultima forma para definir
sus dependencias.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p>Si al usar el <em>plugin</em> <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a> se usó con algún identificador un
array:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
      <span class="nx">L</span><span class="o">:</span> <span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
      <span class="s2">&quot;L.MarkerClusterGroup&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;leaflet.markerclustergroup&quot;</span><span class="p">,</span> <span class="s2">&quot;MarkerClusterGroup&quot;</span><span class="p">]</span>
   <span class="p">})</span>
<span class="p">]</span>
</pre></div>
</div>
<p>entonces la propiedad exportada (<em>MarkerClusterGroup</em> en este ejemplo),
será añadida automáticamente a la variable global que se indique en
<em>externals</em>. Por ese motivo, <em>externals</em> debe definirse así:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">leaflet</span><span class="o">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
   <span class="s2">&quot;leaflet.markerclustergroup&quot;</span><span class="o">:</span> <span class="s2">&quot;L&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">y no asociando <code class="code docutils literal notranslate"><span class="pre">[&quot;L&quot;,</span> <span class="pre">&quot;MarkerCLusterGroup&quot;]</span></code> a
<em>leaflet.markerclustergroup</em>.</p>
</div>
</li>
<li><p class="first">Para el <strong>resto</strong> de ficheros, la forma de exclusión depende de cómo se
importara:</p>
<ul>
<li><p class="first">Si se hizo a través del punto de entrada en la configuración, la solución
es que no aparezca en el punto de entrada, así que en caso de tener salidas
que incluyen dependencias y salidas sin ellas, habría que hacer una
configuración condicional en que el valor del punto de entrada dependiera de
cuál es el sabor de la salida que se genera.</p>
</li>
<li><p class="first">Si la importación se incluyó en el código, la forma de evitar que los
ficheros pasen a la salida es usar el cargador <a class="reference external" href="https://github.com/cherrry/ignore-loader">ignore-loader</a>, que como
elocuentemente indica su nombre, no hace absolutamente nada con el fichero
que trata.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Tenga presente que si no tenemos ficheros propios (<abbr title="Cascading Style Sheets">CSS</abbr>, por
ejemplo) es bastante sencillo hacer una configuración condicional para
que en el sabor <em>bundle</em> se traten los ficheros con el cargador adecuado
y en los sabores sin dependencias con <strong class="program">ignore-loader</strong>. Sin
embargo, si nuestra librería incorpora ficheros propios entonces en los
sabores sin dependencias habrá que distintguir si el fichero procede de
<code class="file docutils literal notranslate"><span class="pre">node_modules</span></code>, en cuyo caso habrá que ignorarlos, o de nuestro
código, en cuyo caso habrá que tratarlo.</p>
<p class="last">Tenga presente, no obstante, <a class="reference internal" href="#webpack-css-no-externals"><span class="std std-ref">la advertencia antes hecha</span></a>.</p>
</div>
</li>
</ul>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">Ver también</p>
<p class="last">En el <a class="reference internal" href="03.ejemplos.html#webpack-ej-plugin"><span class="std std-ref">ejemplo de desarrollo de un plugin</span></a>
ponemos en prácticas todas estas técnicas, incluida la nota justamente
anterior.</p>
</div>
</div>
</div>
<div class="section" id="salida">
<span id="webpack-output"></span><h2>3.2.2.3. Salida<a class="headerlink" href="#salida" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hasta el momento, la definición de nuestra salida se ha reducido a:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;js/[name].bundle.js&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>o sea, a definir el nombre que tendrá cada <a class="reference internal" href="#webpack-entry-point"><span class="std std-ref">punto de entrada</span></a>. Además, por defecto, el directorio predeterminado de
salida es <code class="file docutils literal notranslate"><span class="pre">dist</span></code>, de modo que, si un punto de entrada se llama
<em>leaflet.mipluginmolon</em>, la salida se almacenará en
<code class="file docutils literal notranslate"><span class="pre">dist/js/leaflet.mipluginmolon.bundle.js</span></code>.</p>
<div class="section" id="ruta">
<h3>3.2.2.3.1. Ruta<a class="headerlink" href="#ruta" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un primer cambio consiste en alterar el fichero predeterminado:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">   <span class="nx">entry</span><span class="o">:</span> <span class="s2">&quot;./src/js/index.js&quot;</span><span class="p">,</span>
</span>   <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&quot;docs&quot;</span><span class="p">),</span>
      <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;js/[name].bundle.js&quot;</span>
   <span class="p">}</span>
<span class="hll"><span class="p">}</span>
</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">config</span>
</pre></div>
</div>
</div>
<div class="section" id="formato">
<span id="webpack-output-formato"></span><h3>3.2.2.3.2. Formato<a class="headerlink" href="#formato" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un segundo aspecto muy importante es la forma en la que el fichero resultante
exporta. Hay
<a class="reference external" href="porquee://webpack.js.org/guides/author-libraries/">diversos formatos</a>, pero
podemos resumir en dos casos nuestras necesidades:</p>
<ul>
<li><p class="first">Si generamos una aplicación final que contiene todos el código necesario,
no tenemos por qué preocuparnos por la salida, ya que el código <em>Javascript</em>
no tiene que relacionarse con ningún otro. Por tanto:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
     <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;js/[name].bundle.js&quot;</span><span class="p">,</span>
  <span class="p">}</span>

<span class="nx">es</span> <span class="nx">más</span> <span class="nx">que</span> <span class="nx">suficiente</span><span class="p">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Si generamos una librería y no una aplicación final, la solución universal
es generar como fichero resultante <a class="reference internal" href="../../02.node/03.modulos.html#mod-umd"><span class="std std-ref">un módulo UMD</span></a>, ya que de
esta manera la librería podrá tanto cargarse directamente en el navegador como
usarse de componente en un desarrollo con <a class="reference external" href="https://nodejs.org/">NodeJS</a>.</p>
<p>Para explicar las posibilidades de esta configuración, lo más apropiado es
partir de un código fuente de ejemplo:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">PI</span> <span class="o">=</span> <span class="s2">&quot;3.141592&quot;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">area</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="nx">PI</span><span class="o">*</span><span class="nx">r</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="p">{</span><span class="nx">area</span><span class="p">,</span> <span class="nx">PI</span><span class="p">};</span>
</pre></div>
</div>
<p>Y empezar a variar la forma en que se exporta. Empecemos así<a class="footnote-reference" href="#id12" id="id4">[4]</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;[name].bundle.js&quot;</span><span class="p">,</span>
   <span class="nx">libraryTarget</span><span class="o">:</span> <span class="s2">&quot;umd&quot;</span><span class="p">,</span>
   <span class="nx">globalObject</span><span class="o">:</span> <span class="s2">&quot;this&quot;</span><span class="p">,</span>
   <span class="nx">umdNamedDefine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Al configurar así, podemos exportar como <a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">X</span> <span class="o">=</span> <span class="nx">requiere</span><span class="p">(</span><span class="s2">&quot;./index.bundle.js&quot;</span><span class="p">);</span>
<span class="nx">X</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>  <span class="c1">// 3.141592</span>
</pre></div>
</div>
<p>o como <em>ES2015</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">X</span> <span class="nx">from</span> <span class="s2">&quot;./index.bundle.js&quot;</span><span class="p">;</span>
<span class="nx">X</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>  <span class="c1">// 3.141592</span>
</pre></div>
</div>
<p>pero el fichero no exportará nada al usarse directamente en el navegador.
También es posible exponer no todo lo exportado, sino una parte:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;[name].bundle.js&quot;</span><span class="p">,</span>
   <span class="nx">libraryTarget</span><span class="o">:</span> <span class="s2">&quot;umd&quot;</span><span class="p">,</span>
   <span class="nx">globalObject</span><span class="o">:</span> <span class="s2">&quot;this&quot;</span><span class="p">,</span>
   <span class="nx">umdNamedDefine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="nx">libraryExport</span><span class="o">:</span> <span class="s2">&quot;PI&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Al hacer esto el resputado de la exportación será exclusivamente <code class="code docutils literal notranslate"><span class="pre">PI</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">X</span> <span class="nx">from</span> <span class="s2">&quot;./index.bundle.js&quot;</span><span class="p">;</span>
<span class="nx">X</span><span class="p">;</span>  <span class="c1">// 3.141592 (o sea, PI)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Si se pretende exportar la exportación predeterminada (<em>default</em>),
basta con darle el valor <em>default</em>:</p>
<div class="last highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">libraryExport</span><span class="o">:</span> <span class="s2">&quot;default&quot;</span>
</pre></div>
</div>
</div>
<p>Para que el módulo sea usable directamente en un navegador, es necesario
incluir <em>library</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;[name].bundle.js&quot;</span><span class="p">,</span>
   <span class="nx">libraryTarget</span><span class="o">:</span> <span class="s2">&quot;umd&quot;</span><span class="p">,</span>
   <span class="nx">globalObject</span><span class="o">:</span> <span class="s2">&quot;this&quot;</span><span class="p">,</span>
   <span class="nx">umdNamedDefine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="nx">library</span><span class="o">:</span> <span class="s2">&quot;X&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Al añadir el atributo, declaramos que en un navegador lo exportado por el
código esté disponible a través de la variable <em>X</em>. En consecuencia si
cargamos desde el <abbr title="HyperText Markup Language">HTML</abbr> así:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;index.bundle.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Tendremos disponible <code class="code docutils literal notranslate"><span class="pre">X.PI</span></code> y <code class="code docutils literal notranslate"><span class="pre">X.area</span></code>. Por su parte, usando
<a class="reference external" href="https://nodejs.org/docs/latest/api/modules.html">CommonJS</a> y <em>ES2015</em> la importación se hará como ya se ha visto. También es
posible exportar, no a una variable global, sino al atributo de una variable
global, en principio, preexistente:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">filename</span><span class="o">:</span> <span class="s2">&quot;[name].bundle.js&quot;</span><span class="p">,</span>
   <span class="nx">libraryTarget</span><span class="o">:</span> <span class="s2">&quot;umd&quot;</span><span class="p">,</span>
   <span class="nx">globalObject</span><span class="o">:</span> <span class="s2">&quot;this&quot;</span><span class="p">,</span>
   <span class="nx">umdNamedDefine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="nx">library</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>De esta manera la exportación estará disponible en <code class="code docutils literal notranslate"><span class="pre">L.X</span></code>, donde se
supone que <code class="code docutils literal notranslate"><span class="pre">L</span></code> es una variable global.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="procesamiento">
<span id="webpack-process"></span><h2>3.2.2.4. Procesamiento<a class="headerlink" href="#procesamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En principio, <strong class="program">webpack</strong> procesa de forma nativa sólo código
<em>Javascript</em> por lo que cualquier otro tipo de fichero requiere declarar
mediante qié cargador debe procesarse. Esto precisamente es lo que se nos
presentó al <a class="reference internal" href="01.intro.html#webpack-simple"><span class="std std-ref">configurar la aplicación simple</span></a> que tenía
ficheros <abbr title="HyperText Markup Language">HTML</abbr> y <abbr title="Cascading Style Sheets">CSS</abbr>.</p>
<p>Para llevar a cabo el procesamiento de ficheros no <em>Javascript</em> se requiere
definir un conjunto de reglas para cada una de las cuales se defina al menos
sobre qué tipo de ficheros se aplica y cuál es el cargador o lista de cargadores
que usará. En el ejemplo anteriormente desarrollado se encontraban estas dos
reglas:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
         <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
         <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
               <span class="s2">&quot;css-loader&quot;</span><span class="p">]</span>
      <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>esto es, una para la página web, que usa el cargador <em>html-loader</em>, y otra para
el <abbr title="Cascading Style Sheets">CSS</abbr> que usa los cargadores <em>css-loader</em> y
<strong class="program">MiniCssExtractPlugin.loader</strong>.</p>
<p>En el ejemplo, hay dos aspectos interesantes a destacar:</p>
<ul>
<li><p class="first">Los cargadores, como en el caso de la primera regla admiten opciones. En este
caso, además de la sintaxis indica arriba, se puede usar otra más compacta:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.html$/</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="s2">&quot;hml-loader?minimize=true&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>en la que las opciones del cargador pueden proporcionarse con una sintaxis
parecida a la <em>query string</em> de una <abbr title="Uniform Resource Locator">URL</abbr>.</p>
</li>
<li><p class="first">En cada regla (como en el caso de la segunda) pueden aplicarse varios
cargadores encadenadamente, Contrariamente a lo que podría parecer más natural
el orden de aplicación es de derecha a izquierda.</p>
</li>
</ul>
<p>Hay, además, otros atributos que pueden añadir <a class="reference external" href="https://webpack.js.org/configuration/module/#condition">condiciones</a> a las reglas como
<a class="reference external" href="https://webpack.js.org/configuration/module/#ruleinclude">include</a>, <a class="reference external" href="https://webpack.js.org/configuration/module/#ruleexclud">exclude</a>, o <a class="reference external" href="https://webpack.js.org/configuration/module/#ruleissuer">issuer</a>, esta última
aplicable no al nombre del recurso que se procesa, sino al nombre del fichero en
el que se encontra la invocación al recurso. También es interesante <a class="reference external" href="https://webpack.js.org/configuration/module/#ruleoneof">oneOf</a> para proporcionar una
lista de reglas, de las que sólo se procesará la primera que se ajuste a las
condiciones indicadas.</p>
<div class="admonition seealso">
<p class="first admonition-title">Ver también</p>
<p class="last">Esta <a class="reference external" href="https://stackoverflow.com/a/46769010">respuesta en stackoverflow.com</a> es bastante elocuente para entender
cómo se aplican las condiciones.</p>
</div>
<p>Es también interesante reseñar que <em>use</em> puede ser una función que devuelva el
array de cargadores, lo que permite generar tal lista dinámicamente:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rsc</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Procesando... &quot;</span><span class="p">,</span> <span class="nx">src</span><span class="p">.</span><span class="nx">resource</span><span class="p">);</span>
      <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;style-loader&quot;</span><span class="p">,</span> <span class="s2">&quot;css-loader&quot;</span><span class="p">];</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="ficheros-en-general">
<h3>3.2.2.4.1. Ficheros en general<a class="headerlink" href="#ficheros-en-general" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si retomamos el <a class="reference internal" href="01.intro.html#webpack-simple-html"><span class="std std-ref">HTML de la aplicación simple</span></a> y añadimos
alguna imagen:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Aplicación simple<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Aplicación simple<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/logo512.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;Logo HTML grande&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;images/logo64.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;Logo HTML pequeño&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Para las imágenes se han tomando el logo de <abbr title="HyperText Markup Language">HTML</abbr>5, descargado de
la <a class="reference external" href="https://www.w3.org/html/logo/">página oficial</a>, en tamaño de 512px y
64px.</p>
</div>
<p>Si probáramos inmediatamente a regenerar el <em>bundle</em>, veríamos que escupe un
error como consecuencia de que no sabe manejar este tipo de ficheros. Para
evitarlo es preciso usar <strong class="program">file-loader</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install file-loader
</pre></div>
</div>
<p>un cargador que es capaz de tomar cualquier fichero y copiarlo en la salida que
indiquemos:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.(png|jpe?g|gif|svg)$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;file-loader?name=images/[name].[ext]&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">En el ejemplo, se utiliza únicamente para imágenes, pero puede ser
cualquier tipo de fichero, incluido <abbr title="Cascading Style Sheets">CSS</abbr>. Sin embargo, no es recomendable
utilizarlo para hojas de estilo en algunos casos. Profundizaremos en el
<a class="reference internal" href="#webpack-css"><span class="std std-ref">procesamiento de CSS más adelante</span></a>.</p>
</div>
<p>Una alternativa a <strong class="program">file-loader</strong> es <strong class="program">url-loader</strong> (que
internamente necesita <strong class="program">file-loader</strong>)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install file-loader url-loader
</pre></div>
</div>
<p>y que se encarga de dos cosas:</p>
<ul class="simple">
<li>Copiar el fichero al resultado final.</li>
<li>Si el fichero es menor que el límite definido (en el ejemplo 4K), en vez
de copiar el fichero genera una <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">dataURI</a> en Base64.</li>
</ul>
<p>Su uso es idéntico al de <strong class="program">file-loader</strong> excepto porque debemos indicar
cuál es el límite:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.(png|jpe?g|gif|svg)$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;url-loader?limit=4096&amp;name=images/[name].[ext]&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Para imágenes exclusivamente puede incorporarse, además, <strong class="program">img-loader</strong>
que funciona como minimizador:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> npm install --save-dev img-loader
</pre></div>
</div>
<p>con una configuración:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.(png|jpe?g|gif|svg)$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span>
      <span class="s1">&#39;url-loader?limit=4096&amp;name=images/[name].[ext]&#39;</span><span class="p">,</span>
      <span class="s1">&#39;img-loader&#39;</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Obsérvese que <strong class="program">file-loader</strong> copia ficheros sin alterarlos,
pero no mantiene la estructura de directorios. En todos los ejemplos que
hemos expuesto, las imágenes estén donde estén, acaban en un subdirectorio
llamado <code class="file docutils literal notranslate"><span class="pre">images</span></code>. Para copiar una estructura completa es necesario
recurrir al plugin <a class="reference external" href="https://github.com/webpack-contrib/copy-webpack-plugin">CopyPlugin</a>.</p>
</div>
</div>
<div class="section" id="css">
<span id="webpack-css"></span><h3>3.2.2.4.2. <abbr title="Cascading Style Sheets">CSS</abbr><a class="headerlink" href="#css" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El procesamiento de ficheros <abbr title="Cascading Style Sheets">CSS</abbr> admite variantes dependiendo de cuál queremos
que sea el resultado del procesamiento. Sin demasiadas explicaciones utilizamos
esta:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span> <span class="s2">&quot;css-loader&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong class="program">css-loader</strong> procesa el <abbr title="Cascading Style Sheets">CSS</abbr> que importa desde el código <em>Javascript</em>
de <em>Javascript</em> o se incluye como punto de entrada. Si se usa este cargador,
hay, sin embargo, otra posibilidad: también procesa los ficheros <abbr title="Cascading Style Sheets">CSS</abbr> que se
refieren a través de la cláusula <code class="code docutils literal notranslate"><span class="pre">&#64;import</span></code>:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">import</span> <span class="s2">&quot;barralateral.css&quot;</span><span class="p">;</span>

<span class="nt">h1</span> <span class="p">{</span> <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
<p id="webpack-import">En este caso, las rutas siguen el criterio general y no de la importación en
código <em>Javascript</em> por lo que esa cláusula cargara el fichero que se
encuentre en el mismo directorio que el fichero que se procesa. Para
incoporar <abbr title="Cascading Style Sheets">CSS</abbr> de terceros, <strong class="program">webpack</strong> incorpora la sintaxis con
virgulilla (<code class="code docutils literal notranslate"><span class="pre">~</span></code>). por ejemplo:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">import</span> <span class="s2">&quot;~leaflet/dist/leaflet.css&quot;</span><span class="p">;</span>

<span class="nt">h1</span> <span class="p">{</span> <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
<p>este código importaría el <abbr title="Cascading Style Sheets">CSS</abbr> de <a class="reference external" href="https://leafletjs.com">Leaflet</a>.</p>
<p>Sea como sea, <strong class="program">css-loader</strong> genera un módulo de <em>Javascript</em>, cuya
salida es inútil, a menos que se siga procesando. Para ello, se presentan
varias alternativas:</p>
<dl class="docutils">
<dt><strong class="program">MiniCssExtractPlugin.loader</strong></dt>
<dd>Toma todos los módulos y los compone en un único fichero <abbr title="Cascading Style Sheets">CSS</abbr> que se coloca
en el directorio de salida definico mediante <em>output</em> y con el nombre que
se proporcione al plugin al incorporarlo a la sección <em>plugins</em>.</dd>
<dt><strong class="program">style-loader</strong></dt>
<dd><p class="first">Toma los módulos y los incluye dentro de un elemento <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style">style</a> del <abbr title="HyperText Markup Language">HTML</abbr>:</p>
<div class="last highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;style-loader&quot;</span><span class="p">,</span> <span class="s2">&quot;css-loader&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt><strong class="program">file-loader</strong>+<strong class="program">extract-loader</strong></dt>
<dd><p class="first"><strong class="program">extract-loader</strong> permite tomar los módulos y generar cadenas de
texto, mientras que <strong class="program">file-loader</strong> es capaz de tomar esas cadenas de
texto y generar ficheros de salida, uno por cadena (o sea, por fichero de
entrada) con lo que se obtendrán multiples ficheros en vez de uno solamente
como al usar <strong class="program">MiniCssExtractPlugin.loader</strong>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;file-loader?name=[path][name].css&quot;</span><span class="p">,</span>
         <span class="s2">&quot;extract-loader&quot;</span><span class="p">,</span>
         <span class="s2">&quot;css-loader&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="last admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Obsérvese que, aunque se obtiene un fichero de salida por cada
fichero de entrada, que es lo que obtendría usando únicamente
<em>file-loader</em>, hay una gran diferencia en esta configuración:
<strong class="program">css-loader</strong> entiende y analiza los ficheros <abbr title="Cascading Style Sheets">CSS</abbr> por lo que es
capaz de reconocer enlaces a otros ficheros incluidos en su contenido a
través de cláusulas <code class="code docutils literal notranslate"><span class="pre">&#64;import</span></code> o <code class="code docutils literal notranslate"><span class="pre">url()</span></code>. El efecto es que esos
ficheros referidos también pasarán a procesarse sin necesidad de
referirlos explícitamente como punto de entrada o importarlos en el código
<em>Javascript</em> con <code class="code docutils literal notranslate"><span class="pre">import</span></code>.</p>
</div>
</dd>
</dl>
<p>Por otro lado, también se puede añadir cargadores que actúan <strong>antes</strong> de la
intervención de <strong class="program">css-loader</strong>:</p>
<dl class="docutils">
<dt><strong class="program">postcss-loader</strong></dt>
<dd><p class="first">Opera sobre el <abbr title="Cascading Style Sheets">CSS</abbr> realizando transformaciones que nos resulten
pertinentes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install --save-dev postcss-loader autoprefixer cssnano
</pre></div>
</div>
<p>Hay al menos dos que nos pueden resultar intersantes:</p>
<ul class="last">
<li><p class="first">La que realiza el plugin <strong class="program">autoprefixer</strong>, que añade prefijos del
vendedor a las opciones cuando es preciso. Obviamente, debe operar
justamente antes de <strong class="program">css-loader</strong>. La configuración, suponiendo que
queramos obtener un único <abbr title="Cascading Style Sheets">CSS</abbr>, quedará del siguiente modo:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
         <span class="s2">&quot;css-loader&quot;</span><span class="p">,</span>
<span class="hll">         <span class="p">{</span>
</span><span class="hll">            <span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;postcss-loader&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span class="hll">               <span class="nx">plugins</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">[</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;autoprefixer&quot;</span><span class="p">)]</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">         <span class="p">}]</span>
</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Para saber para qué navegadores debe añadir prefijos, este <em>plugin</em>
usa la <a class="reference internal" href="#browserlist"><span class="std std-ref">librería browserlist</span></a>, que introduciremos al
tratar <a class="reference internal" href="#babel"><span class="std std-ref">babel</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Para comprobar que este cargador realmente actúa, podemos
añadir al <abbr title="Cascading Style Sheets">CSS</abbr> de algún ejemplo, las líneas:</p>
<div class="last highlight-js notranslate"><div class="highlight"><pre><span></span><span class="o">::</span><span class="nx">placeholder</span> <span class="p">{</span>
   <span class="nx">color</span><span class="o">:</span> <span class="nx">gray</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">La que realiza el plugin <strong class="program">cssnano</strong>, que minimiza el
<abbr title="Cascading Style Sheets">CSS</abbr>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
         <span class="s2">&quot;css-loader&quot;</span><span class="p">,</span>
<span class="hll">         <span class="p">{</span>
</span><span class="hll">            <span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;postcss-loader&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span class="hll">               <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span><span class="hll">                  <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;cssnano&quot;</span><span class="p">)({</span><span class="nx">preset</span><span class="o">:</span> <span class="s2">&quot;default&quot;</span><span class="p">})</span>
</span><span class="hll">               <span class="p">]</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">         <span class="p">}]</span>
</span><span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt><strong class="program">sass-loader</strong> o <strong class="program">less-loader</strong> u otra cargador semejante.</dt>
<dd><p class="first">Cuando no escribimos el estilo en <abbr title="Cascading Style Sheets">CSS</abbr> sino en otro lenguaje como <abbr title="Syntactically Awesome Style Sheets">SASS</abbr> o
<a class="reference external" href="http://lesscss.org/">Less</a>, requerimos de otro cargador previo que sea capaz de cargar el traductor
que realice la tranformación a <abbr title="Cascading Style Sheets">CSS</abbr>. Por ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install --save-dev sass-loader node-sass
<span class="gp">$</span> npm install --save-dev less-loader node-less
</pre></div>
</div>
<p>Si optamos por <abbr title="Syntactically Awesome Style Sheets">SASS</abbr>, la configuración podría ser esta<a class="footnote-reference" href="#id13" id="id5">[5]</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.(css|sass)$/i</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span> <span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
         <span class="s2">&quot;css-loader&quot;</span><span class="p">,</span>
         <span class="c1">// Aquí en medio podríamos postcss-loader</span>
         <span class="s2">&quot;sass-loader&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Como el procesador de <abbr title="Syntactically Awesome Style Sheets">SASS</abbr> no lleva a cabo ninguna transformación si se
topa con un fichero <abbr title="Cascading Style Sheets">CSS</abbr>, la regla anterior es perfectamente válida también
para ficheros <abbr title="Cascading Style Sheets">CSS</abbr>.</p>
<p>Con esta regla, podríamos escribir el estilo:</p>
<div class="last highlight-sass notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Fichero sass/main.sass */</span>
<span class="nv">$fondo</span><span class="o">:</span> <span class="ni">yellow</span>

<span class="nt">body</span>
   <span class="na">background-color</span><span class="o">:</span> <span class="nv">$fondo</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="procesamiento-automatico">
<h3>3.2.2.4.3. Procesamiento automático<a class="headerlink" href="#procesamiento-automatico" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Por procesar ficheros automáticamente entendemos hacer que participen en el
procesamiento y pasen a formar parte del resultado sin incluirlos explícitamente
como punto de entrada. Se procesan automáticamente:</p>
<ul class="simple">
<li>Si se usa el plugin <a class="reference external" href="https://github.com/jantimon/html-webpack-plugin">HtmlWebPackPlugin</a>, las imágenes referidas en los
atributos <em>src</em> de las etiquetas <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img">img</a>.</li>
<li>Si se usa <strong class="program">css-loader</strong> para procesar el código <abbr title="Cascading Style Sheets">CSS</abbr>, las imágenes
incluidas en sentencias <code class="code docutils literal notranslate"><span class="pre">url()</span></code> y las hojas importadas <a class="reference internal" href="#webpack-import"><span class="std std-ref">a través de
&#64;import</span></a>.</li>
</ul>
<p>En cambio, si referimos directamente un fichero dentro del código <em>Javascript</em>
como en el ejemplo:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">);</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;alt&quot;</span><span class="p">,</span> <span class="s2">&quot;Logo introducido al vuelo&quot;</span><span class="p">);</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;images/logo.svg&quot;</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="file docutils literal notranslate"><span class="pre">images/logo.svg</span></code> no se detectará como recurso y, en consecuencia, la
imagen no se procesará automáticamente. Para forzar este procesamiento, lo que
se debe hacer es importar el fichero a una variable y usar esta variable como
recurso:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">logo</span> <span class="nx">from</span> <span class="s2">&quot;./logo.svg&quot;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">);</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;alt&quot;</span><span class="p">,</span> <span class="s2">&quot;Logo introducido al vuelo&quot;</span><span class="p">);</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="nx">logo</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="compatibilidad">
<span id="babel"></span><h2>3.2.2.5. Compatibilidad<a class="headerlink" href="#compatibilidad" title="Enlazar permanentemente con este título">¶</a></h2>
<p><strong class="program">Babel</strong> es un componente fundamental de nuestro propósito puesto que
permite sustituir sintaxis demasiado nueva por otra compatible con versiones más
antiguas de <em>Javascript</em>. Para usarlo y que transpile<a class="footnote-reference" href="#id14" id="id6">[6]</a> de forma que quede una
sintaxis ampliamente soportada, podemos añadir algunas líneas a
<code class="file docutils literal notranslate"><span class="pre">webpack/webpack.production.js</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-merge&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">common</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./webpack.common.js&#39;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">common</span><span class="p">,</span> <span class="p">{</span>
   <span class="nx">mode</span><span class="o">:</span> <span class="s2">&quot;production&quot;</span><span class="p">,</span>
   <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
         <span class="p">{</span>
            <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span>
            <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
            <span class="nx">use</span><span class="o">:</span> <span class="p">{</span>
               <span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;babel-loader&quot;</span><span class="p">,</span>
               <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                  <span class="c1">// presets: [ &quot;@babel/env&quot; ]  // Sin opciones.</span>
                  <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span>
                     <span class="p">[</span><span class="s2">&quot;@babel/env&quot;</span><span class="p">,</span> <span class="p">{</span>
                        <span class="nx">debug</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                     <span class="p">}]</span>
                  <span class="p">]</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">},</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">config</span>
</pre></div>
</div>
<p>e instalar los paquetes pertinentes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install --save-dev babel-loader @babel/core @babel/cli @babel/preset-env
</pre></div>
</div>
<p id="browserlist">Este es el uso más simple, pero podemos ser bastante precisos y afinar mucho más
cuáles son los navegadores que pretendemos soportar. Para ello, debemos tener
presente que <strong class="program">babel</strong> es capaz de usar <a class="reference external" href="https://github.com/browserslist/browserslist">la librería browserslist</a>, en cuya documentación puede
leerse cómo expresar el grado de compatibilidad que se pretende conferir al
código. Hay varios modos de incluir este grado de compatibilidad, pero la
documentación recomienda el de incluirlo en <code class="file docutils literal notranslate"><span class="pre">package.json</span></code> a través de
la propiedad <em>browserslist</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;browserslist&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;production&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;cover 95% in ES&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;oneplus&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;&gt; 1% in ES&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;ie10&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;&gt; .25% in ES&quot;</span><span class="p">,</span>
     <span class="s2">&quot;ie &gt;= 10&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;relaxed&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;cover 80% in ES&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Para probar la lista de navegadores que soportará el código podemos usar la
orden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ npx browserslist
</pre></div>
</div>
<p>que usa la definición dada por <em>production</em>, pero podemos aplicar cualquier otra,
dando un valor a la variable de ambiente <em>NODE_ENV</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ NODE_ENV=relaxed npx browserslist
</pre></div>
</div>
<p>Por tanto, podemos componer nuestra aplicación con:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ npm run build
$ NODE_ENV=relaxed npm run build
</pre></div>
</div>
<p class="rubric">Polyfill</p>
<p>Si se requiere dar soporte en navegadores antiguos a funciones como <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>,
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">Object.assign</a> o <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from">Array.from</a> es precisa una configuración más que depende de
si disponemos de una versión de <strong class="program">babel</strong> anterior a la <strong>7.4</strong>.</p>
<p>Para versiones anteriores se debe:</p>
<ol class="arabic">
<li><p class="first">Instalar el paquete <em>&#64;babel/polyfill</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># npm install --save @babel/pollyfill</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">No hay errata. Se debe instalar como dependencia y no como
dependencia de desarrollo.</p>
</div>
</li>
<li><p class="first">Modificar la configuración de <strong class="program">webpack</strong> para añadir una opción a
<strong class="program">babel</strong>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-merge&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">common</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./webpack.common.js&#39;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">common</span><span class="p">,</span> <span class="p">{</span>
   <span class="nx">mode</span><span class="o">:</span> <span class="s2">&quot;production&quot;</span><span class="p">,</span>
   <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
         <span class="p">{</span>
            <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span>
            <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
            <span class="nx">use</span><span class="o">:</span> <span class="p">{</span>
               <span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;babel-loader&quot;</span><span class="p">,</span>
               <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                  <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span>
                     <span class="p">[</span><span class="s2">&quot;@babel/env&quot;</span><span class="p">,</span> <span class="p">{</span>
                        <span class="nx">debug</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="hll">                        <span class="nx">useBuiltIns</span><span class="o">:</span> <span class="s2">&quot;usage&quot;</span><span class="p">,</span>
</span>                     <span class="p">}]</span>
                  <span class="p">]</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">},</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">config</span>
</pre></div>
</div>
<p>Con esa opción, sólo se añadirán al código <em>Javascript</em> resultante, el
codigo necesario para implementar las funciones pertienen que hayamos
incorporado al código.</p>
</li>
</ol>
<p>A partir de la versión <em>7.4.0</em>, <a class="reference external" href="https://babeljs.io/docs/en/babel-polyfill">la documentación recomienda usar core-js</a> para lo cual:</p>
<ol class="arabic">
<li><p class="first">Instalamos el paquete correspondiente:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># npm install --save core-js@3</span>
</pre></div>
</div>
</li>
<li><p class="first">Modificamos la configuración de <strong class="program">webpack</strong> para añadir un par de
opciones a <strong class="program">babel</strong>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-merge&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">common</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./webpack.common.js&#39;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">common</span><span class="p">,</span> <span class="p">{</span>
   <span class="nx">mode</span><span class="o">:</span> <span class="s2">&quot;production&quot;</span><span class="p">,</span>
   <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
         <span class="p">{</span>
            <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span>
            <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
            <span class="nx">use</span><span class="o">:</span> <span class="p">{</span>
               <span class="nx">loader</span><span class="o">:</span> <span class="s2">&quot;babel-loader&quot;</span><span class="p">,</span>
               <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                  <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span>
                     <span class="p">[</span><span class="s2">&quot;@babel/env&quot;</span><span class="p">,</span> <span class="p">{</span>
                        <span class="nx">debug</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="hll">                        <span class="nx">useBuiltIns</span><span class="o">:</span> <span class="s2">&quot;usage&quot;</span><span class="p">,</span>
</span><span class="hll">                        <span class="nx">corejs</span><span class="o">:</span> <span class="mi">3</span>
</span>                     <span class="p">}]</span>
                  <span class="p">]</span>
               <span class="p">}</span>
            <span class="p">}</span>
         <span class="p">},</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">config</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Para probar la configuración, podemos añadir alguna sentencia sencilla
al nuestro código <em>Javscript</em> que requiera <em>polyfill</em> como, por ejemplo:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</pre></div>
</div>
<p class="last">Si probamos a generar le código con y sin la sentencia anterior y comparamos
cuánto pesan ambos ficheros veremos una ostensible diferencia, ya que con la
sentencia propuesta se tendrá que añadir el código necesario para implementar
la función. Como sólo se añade el código indispensable para implementar las
funciones necesarias, es buena idea configurar siempre <em>polyfill</em>.</p>
</div>
</div>
<div class="section" id="depuracion">
<span id="webpack-debug"></span><h2>3.2.2.6. Depuración<a class="headerlink" href="#depuracion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para un desarrollo ágil de la aplicación es fundamental que configuremos
adecuadamente <strong class="program">webpack-dev-server</strong>, a fin de que podamos comprobar
sobre la marcha los cambios que aplicamos al código. Esta configuración se hace
a través del atributo <em>devServer</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">devServer</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">open</span><span class="o">:</span> <span class="s2">&quot;chromium&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En principio, sirve a través del servidor web (en la dirección
<code class="file docutils literal notranslate"><span class="pre">http:/localhost:8080</span></code>) los ficheros resultantes del procesamiento, los
cuales <strong>no</strong> llegan a escribirse en disco.  Además, fusiona con ellos el
directorio raíz del proyecto. En consecuencia, si nuestro proyecto tiene unos
ficheros originales <code class="file docutils literal notranslate"><span class="pre">src/index.html</span></code> y <code class="file docutils literal notranslate"><span class="pre">src/index.js</span></code> que se
transforman en <code class="file docutils literal notranslate"><span class="pre">dist/index.html</span></code> y <code class="file docutils literal notranslate"><span class="pre">dist/index.bundle.js</span></code> resultará
que:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Fichero</th>
<th class="head">Accesible mediante</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="file docutils literal notranslate"><span class="pre">src/index.html</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/src/index.html</span></code></td>
</tr>
<tr class="row-odd"><td><code class="file docutils literal notranslate"><span class="pre">src/index.js</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/src/index.js</span></code></td>
</tr>
<tr class="row-even"><td><code class="file docutils literal notranslate"><span class="pre">dist/index.html</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/index.html</span></code></td>
</tr>
<tr class="row-odd"><td><code class="file docutils literal notranslate"><span class="pre">dist/index.bundle.js</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/index.bundle.js</span></code></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Obsérvese que la ruta relativa entre los ficheros generados
y los fichero no generados cambia en el servidor web. Esto no quiere
decir que el directorio <code class="file docutils literal notranslate"><span class="pre">dist/</span></code> desaparezca. Si existía previamente
y contenía ficheros de anteriores procesamientos estos continuarán siendo
accesibles dentro de <code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/dist</span></code>. Son los ficheros
generados, que no se llegan a escribir físicamente en disco, los que aparecen
en la raíz del servidor.</p>
</div>
<p>Este comportamiento, sin embargo. puede alterarse con algunas opciones:</p>
<ul>
<li><p class="first"><em>contentBase</em> indica un directorio del sistema de ficheros que se
quiere fusionar con la directorio raíz del servidor wen. Su valor
predeterminado es el directorio raíz del proyecto, de ahí que resulte lo que
acabamos de explicar.  Podemos, no obstante, definir otro cualquiera (usando
una ruta relativa, eso sí). Por ejemplo:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="nx">devServer</span><span class="o">:</span> <span class="p">{</span>
     <span class="nx">contentBase</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&quot;examples&quot;</span><span class="p">),</span>
     <span class="c1">//watchContentBase: true,</span>
     <span class="nx">open</span><span class="o">:</span> <span class="s2">&quot;chromium&quot;</span>
  <span class="p">}</span>

<span class="nx">en</span> <span class="nx">cuyo</span> <span class="nx">caso</span><span class="p">,</span> <span class="nx">se</span> <span class="nx">fusionará</span> <span class="nx">el</span> <span class="nx">subdirectorio</span> <span class="o">:</span><span class="nx">file</span><span class="o">:</span><span class="sb">`examples`</span><span class="p">.</span> <span class="nx">Si</span><span class="p">,</span> <span class="nx">además</span><span class="p">,</span>
<span class="nx">añadimos</span> <span class="o">*</span><span class="nx">watchContentBase</span><span class="o">*</span> <span class="nx">el</span> <span class="nx">servidor</span> <span class="nx">no</span> <span class="nx">sólo</span> <span class="nx">vigilará</span> <span class="nx">cambios</span> <span class="nx">en</span> <span class="nx">los</span>
<span class="nx">ficheros</span> <span class="nx">generados</span><span class="p">,</span> <span class="nx">sino</span> <span class="nx">también</span> <span class="nx">cambios</span> <span class="nx">en</span> <span class="nx">los</span> <span class="nx">ficheros</span> <span class="nx">estáticos</span> <span class="nx">contenidos</span>
<span class="nx">en</span> <span class="o">:</span><span class="nx">file</span><span class="o">:</span><span class="sb">`examples`</span><span class="p">.</span>

<span class="nx">Si</span> <span class="nx">el</span> <span class="nx">valor</span> <span class="nx">de</span> <span class="o">*</span><span class="nx">contentBase</span><span class="o">*</span> <span class="nx">es</span> <span class="sb">``</span><span class="kc">false</span><span class="sb">``</span><span class="p">,</span> <span class="nx">sólo</span> <span class="nx">estarán</span> <span class="nx">disponibles</span> <span class="nx">los</span>
<span class="nx">ficheros</span> <span class="nx">generados</span><span class="p">.</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>publicPath</em> permite cambiar la ruta en el servidor donde aparecerán los
ficheros generados. En consecuencia, esta configuración:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">devServer</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">publicPath</span><span class="o">:</span> <span class="s2">&quot;/dist/&quot;</span><span class="p">,</span>
   <span class="nx">open</span><span class="o">:</span> <span class="s2">&quot;chromium&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>provocará este efecto:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Fichero</th>
<th class="head">Accesible mediante</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="file docutils literal notranslate"><span class="pre">src/index.html</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/src/index.html</span></code></td>
</tr>
<tr class="row-odd"><td><code class="file docutils literal notranslate"><span class="pre">src/index.js</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/src/index.js</span></code></td>
</tr>
<tr class="row-even"><td><code class="file docutils literal notranslate"><span class="pre">dist/index.html</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/dist/index.html</span></code></td>
</tr>
<tr class="row-odd"><td><code class="file docutils literal notranslate"><span class="pre">dist/index.bundle.js</span></code></td>
<td><code class="file docutils literal notranslate"><span class="pre">http://localhost:8080/dist/index.bundle.js</span></code></td>
</tr>
</tbody>
</table>
<p>Como puede verse, los ficheros estáticos del sistema de ficheros siguen
compartiéndose en la raíz del servidor web.</p>
</li>
</ul>
<p>Por su parte, la otra opción, <em>open</em>, rige qué se hace al levantar el
servidor:</p>
<ul>
<li><p class="first">Si es <code class="docutils literal notranslate"><span class="pre">false</span></code>, que es su valor predeterminado al no haber incluido el
argumento <code class="code docutils literal notranslate"><span class="pre">--open</span></code><a class="footnote-reference" href="#id15" id="id7">[7]</a> en <code class="file docutils literal notranslate"><span class="pre">package.json</span></code>, no se abre una ventana
con la aplicación en el navegador, así que tendremos que abrir manualmente
nosotros la página eni la dirección:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span>
</pre></div>
</div>
</li>
<li><p class="first">Si toma valor, debe ser una cadena que indique el navegador con el que se
quiere ver la aplicación.</p>
</li>
<li><p class="first">Si es <code class="docutils literal notranslate"><span class="pre">true</span></code>, se usa el navegador predefinido por el sistema<a class="footnote-reference" href="#id16" id="id8">[8]</a>.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Aunque tenga un interés muy relativo, también es posible hacer
que los ficheros resultantes se escriban en disco.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">devServer</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">writeToDisk</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="nx">contentBase</span><span class="o">:</span> <span class="kc">false</span>
   <span class="nx">open</span><span class="o">:</span> <span class="s2">&quot;chromium&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">En este caso, además de publicarse el contenido a través del servidor, se
escribirán los ficheros resultantes en el directorio de salida.</p>
</div>
</div>
<div class="section" id="optimizacion">
<h2>3.2.2.7. Optimización<a class="headerlink" href="#optimizacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Es sumamente importante mantener los ficheros resultantes dentro de un tamaño
razonable. En muchas ocasiones, el resultado contiene código inútil porque se
cargó, pero no se usa en absoluto. El apartado indica cómo localizar cuáles son
los módulos que más contribuyen al tamaño de nuestro código y cómo eliminar
código inútil.</p>
<div class="section" id="auscultador">
<h3>3.2.2.7.1. Auscultador<a class="headerlink" href="#auscultador" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un primer paso para conocer por qué nuestro desarrolla ocupa el espacio que
ocupa, es determinar cuánto contribuye a él cada uno de sus componentes. Para
tal tarea, una herramienta muy práctica es <a class="reference external" href="https://www.npmjs.com/package/webpack-bundle-analyzer">webpack-bundle-analyzer</a> que nos mostrará
gráficamente esta contribución:</p>
<img alt="../../_images/analyzer.png" src="../../_images/analyzer.png" />
<p>Para hacer uso de ella debemos instalar la utilidad:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm install --save-dev webpack-bundle-analyzer</span>
</pre></div>
</div>
<p>y en la configuración para producción añadir temporalmente:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">BundleAnalyzerPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-bundle-analyzer&#39;</span><span class="p">).</span><span class="nx">BundleAnalyzerPlugin</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
   <span class="c1">// ...</span>
   <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
      <span class="k">new</span> <span class="nx">BundleAnalyzerPlugin</span><span class="p">(),</span>
      <span class="c1">// ...</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Al llevar a cabo la generación de los ficheros, se levantará en
<code class="file docutils literal notranslate"><span class="pre">http://localhost:8888</span></code> la aplicación de la que se puso antes captura y
podremos comprobar cuál es el espacio al que contribuye cada componente.</p>
</div>
<div class="section" id="carga-parcial">
<h3>3.2.2.7.2. Carga parcial<a class="headerlink" href="#carga-parcial" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para reducir el tamaño, lo más eficaz es eliminar el código que no se utilice.
Por ejemplo, si en nuestro desarrollo necesitamos análisis geoespacial,
podríamos estar tentados a hacer:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
      <span class="nx">turf</span><span class="o">:</span> <span class="s2">&quot;@turf/turf&quot;</span>
   <span class="p">});</span>
<span class="p">]</span>
</pre></div>
</div>
<p>o el equivalente con <code class="code docutils literal notranslate"><span class="pre">import</span></code> dentro del código. Sin embargo, <a class="reference external" href="https://turfjs.org/">TurfJS</a> es
una librería mastodóntica y es probable que nosotros sólo pretendamos hacer uso
de algunas de sus funciones. Por ejemplo, <code class="code docutils literal notranslate"><span class="pre">turf.difference</span></code> y
<code class="code docutils literal notranslate"><span class="pre">turf.union</span></code>. En ese caso, tenemos dos opciones:</p>
<ol class="arabic">
<li><p class="first">Crear nuestro propio módulo, que cargue sólo estas dos funciones:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// ./src/turf.js</span>
<span class="kr">import</span> <span class="nx">difference</span> <span class="nx">from</span> <span class="s2">&quot;@turf/difference&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">union</span> <span class="nx">from</span> <span class="s2">&quot;@turf/union&quot;</span><span class="p">;</span>

<span class="kr">export</span> <span class="p">{</span><span class="nx">difference</span><span class="p">,</span> <span class="nx">booleanPointInPolygon</span><span class="p">};</span>
</pre></div>
</div>
<p>y asociarlo al identificador <em>turf</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
      <span class="nx">turf</span><span class="o">:</span> <span class="s2">&quot;./src/turf.js&quot;</span>
   <span class="p">});</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Y si queremos <em>externalizar</em> el uso de la librería:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;./scr/turf.js&quot;</span><span class="o">:</span> <span class="s2">&quot;turf&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Definir los dos identificadores por separado:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
      <span class="s2">&quot;turf.difference&quot;</span><span class="o">:</span> <span class="s2">&quot;@turf/difference&quot;</span><span class="p">,</span>
      <span class="s2">&quot;turf.union&quot;</span><span class="o">:</span> <span class="s2">&quot;@turf/union&quot;</span><span class="p">,</span>
   <span class="p">});</span>
<span class="p">]</span>
</pre></div>
</div>
<p>lo cual exigirá la siguiente <em>externalización</em>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;@turf/difference&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;turf&quot;</span><span class="p">,</span> <span class="s2">&quot;difference&quot;</span><span class="p">],</span>
    <span class="s2">&quot;@turf/union&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;turf&quot;</span><span class="p">,</span> <span class="s2">&quot;union&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="multiples-resultados">
<span id="webpack-multi"></span><h2>3.2.2.8. Múltiples resultados<a class="headerlink" href="#multiples-resultados" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Lo habitual es que para un desarrollo nos interese generar varias salidas
distintas tales como:</p>
<ol class="arabic">
<li><p class="first"><code class="file docutils literal notranslate"><span class="pre">script.js</span></code>: De <strong>producción</strong>, transpilada, minimizada y sin
dependencias. La generaremos con:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm run build</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal notranslate"><span class="pre">script.bundle.js</span></code>: De <strong>producción</strong>, transpilada, minimizada y con
todas las dependencias. La generaremos con:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm run build:bundle</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal notranslate"><span class="pre">script-src.js</span></code>: De <strong>producción</strong>, transpilada, no minimazada y
sin dependencias. La generaremos con:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm run build:src</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal notranslate"><span class="pre">script-debug.js</span></code>: De <strong>desarrollo</strong>, no transpilada ni minimizada y
sin dependencias. Además, debería incluir mapeos del código. La generaremos
con:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm run build:debug</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal notranslate"><span class="pre">script.js</span></code>: De <strong>desarrollo</strong> como la anterior para deparar
interactivamente con <strong class="program">webpack-dev-server</strong>. La generaremos con</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npm run debug</span>
</pre></div>
</div>
</li>
</ol>
<p>Para esto, deberemos dejar unos <em>scripts</em> en <code class="file docutils literal notranslate"><span class="pre">package.json</span></code> así:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;build&quot;</span><span class="o">:</span> <span class="s2">&quot;webpack --env.output=min&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build:bundle&quot;</span><span class="o">:</span> <span class="s2">&quot;webpack --env.output=bundle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build:src&quot;</span><span class="o">:</span> <span class="s2">&quot;webpack --env.output=src&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build:debug&quot;</span><span class="o">:</span> <span class="s2">&quot;webpack --env.output=srcdebug&quot;</span><span class="p">,</span>
    <span class="s2">&quot;debug&quot;</span><span class="o">:</span> <span class="s2">&quot;webpack-dev-server --env.output=debug&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>donde la forma de distinguir una salida de otra es mediante un objeto <em>env</em> que
nos encargaremos de desarrollar más adelante. No obstante, dependiendo de cuál
sea el objetivo de nuestro desarrollo podremos prescindir de algunas salidas:</p>
<ul class="simple">
<li>Para una aplicación final, suele bastar con las salidas (2) y (5).</li>
<li>Si desarrollamos una librería intermedia pueden llegar a interesarnos hasta
las cinco salidas:<ol class="arabic">
<li>Para usarse directamente con el navegador.</li>
<li>Paa el mismo uso anterior, pero evitando que se deban cargar las
dependencias.</li>
<li>Para incorporarla a otros proyectos desarrollados con <a class="reference external" href="https://nodejs.org/">NodeJS</a>.</li>
<li>Para brindar la posibilidad a un tercero de analizar el código sin instalar
el paquete y usar <a class="reference external" href="https://nodejs.org/">NodeJS</a> y <strong class="program">webpack</strong>.</li>
<li>Para depurar cómodamente mientras desarrollamos la aplicación.</li>
</ol>
</li>
</ul>
<p>Los ejemplos que trataremos, desarrollarán dos casos de ejemplo: uno desarrolla
una aplicación final, y el otro un sencillo <em>plugin</em> para <a class="reference external" href="https://leafletjs.com">Leaflet</a>, o sea, una
libería intermedia.</p>
</div>
<div class="section" id="comprobacion">
<h2>3.2.2.9. Comprobación<a class="headerlink" href="#comprobacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Es bastante interesante comprobar si la configuración que hemos llevado a cabo
genera el objeto de configuración que presuponemos. Para ello, y suponiendo que
hayamos usando el objeto <em>env</em>, podemos usar la consola de <a class="reference external" href="https://nodejs.org/">NodeJS</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;</span> <span class="nv">x</span> <span class="o">=</span> require<span class="o">(</span><span class="s2">&quot;./webpack.config.js&quot;</span><span class="o">)</span><span class="p">;</span>
<span class="gp">&gt;</span> x<span class="o">({</span>output: <span class="s2">&quot;min&quot;</span><span class="o">})</span><span class="p">;</span>  // Y el resto de salidas.
</pre></div>
</div>
<p>Se imprimirá el objeto de configuración resultante y podremos comprobar si es el
que esparábamos.</p>
<p class="rubric">Notas al pie</p>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Entiéndase que los dos scripts no tienen por qué corresponderse con dos
ficheros. Cada uno de ellos puede estar programado de forma modular y
componerse de múltiples ficheros.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>A menos claro está que hayamos hecho una copia incluida en nuestro
desarrollo de ese módulo ajeno, porque el problema de las librerías de
terceros es que se encuentran alojadas fuera del directorio de trabajo (en
<code class="file docutils literal notranslate"><span class="pre">node_modules</span></code> o en el directorio global de instalación) y esa
localización no es alcanzable por un cliente web. Otra solución es usar el
plugin <a class="reference external" href="https://webpack.js.org/plugins/provide-plugin/">Provide</a>, que se explica a continuación.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>Y aquí rige para las rutas <a class="reference internal" href="../../02.node/03.modulos.html#webpack-import-path"><span class="std std-ref">la misma regla que para las
importaciones dentro del código</span></a>. Por tanto, <em>leaflet</em>
a secas implica que estamos cargando una librería instalada local o
globalmente y que, en realidad, se importa el fichero que se indique como
principal en <code class="file docutils literal notranslate"><span class="pre">package.json</span></code>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><p class="first">La línea del código:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">globalObject</span><span class="o">:</span> <span class="s2">&quot;this&quot;</span>
</pre></div>
</div>
<p class="last">define el objeto global que, por defecto, es <em>windows</em> y, por tanto, hace la
aplicación exclusivamente ejecutable en navegadores. Esa es nuestra
intención, así que podríamos ahorrarnos la línea; pero al fijarlo a <em>this</em>,
el código se hace ejecutable tanto en un navegador como en <a class="reference external" href="https://nodejs.org/">NodeJS</a>, con lo
que podemos hacer pruebas en la propia consola.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>También podemos usar <strong class="program">postcss-loader</strong>, entre <strong class="program">css-loader</strong>
y <strong class="program">sass-loader</strong>, pero importa poco a efectos de esta discusión.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><em>Transpilar</em> (y transpilación y transpilador) es un término
construido por analogía con el verbo <em>compilar</em>. De un modo análogo al que
<em class="dfn">compilar</em> sea convertir código de programación en código máquina,
<em class="dfn">transpilar</em> es traducir còdigo de programación a una versión distinta,
por ejemplo, a una más antigua para mantener la compatibilidad con versiones
más antiguas del intérprete. Traducir de <a class="reference external" href="https://coffeescript.org/#introduction">CoffeeScript</a> o <a class="reference external" href="https://www.typescriptlang.org/">TypeScript</a> a
<em>Javascript</em> también es <em>transpilar</em>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td><p class="first">En los sistemas <em>linux</em>, el navegador predefinido es el que se obtiene
así:</p>
<div class="last highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> xdg-settings get default-web-browser
<span class="go">firefox-esr.desktop</span>
</pre></div>
</div>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td><p class="first">Las variables de entorno que se pasan de forma estándar (véase <em>NODE_ENV</em>
cuando se trataba <a class="reference internal" href="#babel"><span class="std std-ref">babel</span></a>) se encuentran disponibles en el
script a través de <code class="code docutils literal notranslate"><span class="pre">process.env</span></code>:</p>
<div class="last highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">HOME</span><span class="p">)</span>
</pre></div>
</div>
</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.2.2. Particularidades</a><ul>
<li><a class="reference internal" href="#punto-de-entrada">3.2.2.1. Punto de entrada</a></li>
<li><a class="reference internal" href="#carga-de-modulos">3.2.2.2. Carga de módulos</a><ul>
<li><a class="reference internal" href="#sistema-de-modulos">3.2.2.2.1. Sistema de módulos</a></li>
<li><a class="reference internal" href="#importacion-desde-la-configuracion">3.2.2.2.2. Importación desde la configuración</a></li>
<li><a class="reference internal" href="#exclusion-de-dependecias">3.2.2.2.3. Exclusión de dependecias</a></li>
</ul>
</li>
<li><a class="reference internal" href="#salida">3.2.2.3. Salida</a><ul>
<li><a class="reference internal" href="#ruta">3.2.2.3.1. Ruta</a></li>
<li><a class="reference internal" href="#formato">3.2.2.3.2. Formato</a></li>
</ul>
</li>
<li><a class="reference internal" href="#procesamiento">3.2.2.4. Procesamiento</a><ul>
<li><a class="reference internal" href="#ficheros-en-general">3.2.2.4.1. Ficheros en general</a></li>
<li><a class="reference internal" href="#css">3.2.2.4.2. <abbr title="Cascading Style Sheets">CSS</abbr></a></li>
<li><a class="reference internal" href="#procesamiento-automatico">3.2.2.4.3. Procesamiento automático</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compatibilidad">3.2.2.5. Compatibilidad</a></li>
<li><a class="reference internal" href="#depuracion">3.2.2.6. Depuración</a></li>
<li><a class="reference internal" href="#optimizacion">3.2.2.7. Optimización</a><ul>
<li><a class="reference internal" href="#auscultador">3.2.2.7.1. Auscultador</a></li>
<li><a class="reference internal" href="#carga-parcial">3.2.2.7.2. Carga parcial</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiples-resultados">3.2.2.8. Múltiples resultados</a></li>
<li><a class="reference internal" href="#comprobacion">3.2.2.9. Comprobación</a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="01.intro.html"
                        title="capítulo anterior">3.2.1. Configuración básica</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="03.ejemplos.html"
                        title="próximo capítulo">3.2.3. Ejemplos</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/03.client/02.webpack/02.part.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="03.ejemplos.html" title="3.2.3. Ejemplos"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="01.intro.html" title="3.2.1. Configuración básica"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Javascript - </a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >3. Programación en el cliente</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >3.2. Webpack</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor 2019, José Miguel Sánchez Alés.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>